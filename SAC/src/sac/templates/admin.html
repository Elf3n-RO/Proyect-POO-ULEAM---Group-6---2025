<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>SIGACC Web - Admin</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>

<body>
    <header>
        <div class="imagen"></div>
        <div class="container">
            <p class="logo">SAC</p>
            <nav>
                {% if admin_logeado %}
                    <a href="/config-page">Configuraci贸n</a>
                    <a href="/admin-panel">Panel Inicio</a>
                    <a href="/">Cerrar Sesi贸n</a>
                {% else %}
                    <a href="#">Soporte</a>
                {% endif %}
            </nav>
        </div>
    </header>

    <section id="principal" style="height: auto; min-height: 80vh; padding-bottom: 50px;">
        <div class="container">
            <div class="imagen"></div>
            
            {% if not admin_logeado %}
                <h1>Bienvenido al Sistema de Asignaci贸n de Cupos</h1>
                <form action="/login" method="POST" class="POST">
                    <label for="correo">锔 Correo Institucional</label>
                    <input type="email" id="correo" name="correo" required>
                    <label for="contrasena"> Contrase帽a</label>
                    <input type="password" id="contrasena" name="contrasena" required>
                    <button type="submit">Iniciar Sesi贸n</button>
                </form>
            {% else %}
                <h1 style="text-align: center;">Panel de Administraci贸n SAC</h1>
                
                {% if mensaje %}
                    <div class="msg-logica">SISTEMA: {{ mensaje }}</div>
                {% endif %}

                <h2 class="titulo-seccion">Ofertas Acad茅micas</h2>
                <table class="tabla-datos">
                    <thead>
                        <tr>
                            <th>Carrera</th>
                            <th>Cupos Totales</th>
                            <th>Vulnerabilidad (15%)</th>
                            <th>M茅rito (20%)</th>
                            <th>Disponibles</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for carrera in carreras %}
                        <tr>
                            <td>{{ carrera.nombre }}</td>
                            <td>{{ carrera.cuposTotales }}</td>
                            <td>{{ carrera.cuposPorSegmento.get('Vulnerabilidad', 0) }}</td>
                            <td>{{ carrera.cuposPorSegmento.get('MeritoAcademico', 0) }}</td>
                            <td><strong>{{ carrera.cuposDisponibles }}</strong></td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>

                <h2 class="titulo-seccion">Postulantes</h2>
                <table class="tabla-datos">
                    <thead>
                        <tr>
                            <th>Identificaci贸n</th>
                            <th>Nombre Completo</th>
                            <th>Puntaje</th>
                            <th>Fecha Registro</th>
                            <th>Vulnerabilidad</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for p in postulantes %}
                        <tr>
                            <td>{{ p.identificacion }}</td>
                            <td>{{ p.nombres }} {{ p.apellidos }}</td>
                            <td style="color: #2e7d32; font-weight: bold; font-size: 1.1em;">{{ p.puntaje }}</td>
                            <td>{{ p.fecha_inscripcion.strftime('%Y-%m-%d') }}</td>
                            <td>{{ p.vulnerabilidad }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>

                <div style="text-align: center; margin-top: 30px;">
                    <form action="/ejecutar-asignacion" method="POST">
                        <button type="submit" class="btn-logica">
                             Ejecutar Asignaci贸n de Cupos (Art. 51)
                        </button>
                    </form>
                </div>
            {% endif %}
        </div>
    </section>

    <section id="ayuda">
        <div class="container">
            <nav>
                {% if admin_logeado %}
                    <form action="/report-page" method="POST" class="POST">
                        <button type="submit">Generar Reporte</button>
                    </form>
                {% else %}
                    <a href="#">Soporte t茅cnico</a>
                    <a href="#">驴Necesitas Ayuda?</a>
                {% endif %}
            </nav>
        </div>
    </section>
</body>
</html>